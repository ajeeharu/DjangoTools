{% extends 'base_calendar.html' %}
{% block title %} {{ page_title }}{% endblock %}
{%block content %}
<div id="content">
	<section class="bg-white">
		<div class="flex flex-row py-4 px-4 mx-auto items-center justify-between">
			<h1 class="mb-2 text-4xl font-extrabold tracking-tight leading-none text-gray-900">
				{{ page_title }}
			</h1>
		</div>
	</section>
	<div class="my-8 mx-4 px-4 rounded-md bg-blue-50 md:max-w-2xl md:mx-auto md:px-8">
		<div class="flex flex-col items-center py-3">
			<div class="flex">
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-blue-400" viewBox="0 0 32 32"
						fill="currentColor">
						<path fillRule="evenodd"
							d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
							clipRule="evenodd" />
					</svg>
				</div>
				<div class="self-center ml-3">
					<div class="text-blue-500 font-semibold text-3xl" id="id_record_organization_name">
					</div>
					<div class="text-blue-500">
						<div class="mt-1">
							<div>
								<label for="day_of_week" class="block mb-2 text-xl font-medium">曜日指定</label>
								<input type="text" name="day_of_week"
									class="bg-gray-50 border border-gray-300 text-xl rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
									readonly="readonly" id="id_record_day_of_week">
							</div>
							<div>
								<label for="semiweekly" class="block mb-2 text-xl font-medium">隔週指定</label>
								<input type="text" name="semiweekly"
									class="bg-gray-50 border border-gray-300 text-xl rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
									readonly="readonly" id="id_record_semiweekly">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
	<div class="items-center my-8 p-16 border border-gray-300 border-solid boredr-2">
		<form id="form-record" class="mt-4 w-full col-span-4" method="post">
			{% csrf_token %}
			<div class="grid grid-cols-2 items-center justify-center gap-4">
				<div class="flex items-center ps-4 border border-gray-300 rounded-sm">
					<input id="holiday_ignore" type="checkbox" value="" name="holiday_ignore"
						class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 focus:ring-2">
					<label for="bordered-checkbox-1"
						class="w-full py-4 ms-2 text-xl font-medium text-gray-600">定休日でも追加する</label>
				</div>
				<div class="flex items-center ps-4 border border-gray-300 rounded-sm">
					<input id="event_clear" type="checkbox" value="" name="event_clear"
						class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-500 focus:ring-2">
					<label for="bordered-checkbox-2"
						class="w-full py-4 ms-2 text-sm font-medium text-gray-600">{{target_year}}年のカレンダーの「<span id="id_span_organization_name"></span>」のイベントをクリアしてから追加する。</label>
				</div>
				<div class="ps-4 border border-gray-300 rounded-sm">
					展開開始日：
					<input id="start_date" type="date" value="{{today}}" name="start_date"
						class="text-blue-600 border-gray-300 rounded-sm py-4 focus:ring-blue-500 focus:ring-2 h-4">
				</div>
				<div class="ps-4 border border-gray-300 rounded-sm">
					展開終了日：
					<input checked id="end_date" type="date" value="{{target_year}}-12-31" name="end_date"
						class="text-blue-600 border-gray-300 rounded-sm py-4 focus:ring-blue-500 focus:ring-2 h-4">
				</div>
				<div class="ps-4 border border-gray-300 rounded-sm">
					申請日：
					<input id="application_date" type="date" value="{{today}}" name="application_date"
						class="text-blue-600 border-gray-300 rounded-sm py-4 focus:ring-blue-500 focus:ring-2 h-4">
				</div>
			</div>
			<button type="submit"
				class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-xl px-5 py-4 mt-4 text-center">
				上記の利用者をイベントを、{{target_year}}年のカレンダーに登録する。
			</button>
		</form>
	</div>
</div>


<script type="text/javascript">
	document.addEventListener("DOMContentLoaded", () => {
		let element_organization_name = document.querySelector("#id_record_organization_name");
		let element_organization_name_span = document.querySelector("#id_span_organization_name");
		let element_day_of_week = document.querySelector("#id_record_day_of_week");
		let element_semiweekly = document.querySelector("#id_record_semiweekly");
		let id = {{ user_id }};

		// API経由でData取得
		const CreateEndPoint = "/api/event_manager/userinformation/" + id + "/";

		fetch(CreateEndPoint, {
			method: 'GET',
			headers: {
				'X-CSRFToken': getCookie('csrftoken'),
				'Content-Type': 'application/json',
			}
		})
		.then((response) => {
			return response.json(); // 読み込むデータをJSONに設定
		})
		.then((data) => {
			element_organization_name.innerHTML = data["organization_name"] + "の情報の展開";
			element_organization_name_span.innerHTML = data["organization_name"];
			element_day_of_week.value = data["day_of_week"]["value"];
			element_semiweekly.value = data["semiweekly"]["value"];
		});
	});

</script>
{% endblock %}